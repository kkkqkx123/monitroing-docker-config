groups:
- name: nebula-personal-alerts
  rules:
  # 个人使用告警阈值调整
  - alert: NebulaPersonalHighSessionUsage
    expr: nebula_num_sessions / nebula_max_sessions > 0.7
    for: 5m  # 缩短告警时间以更快响应
    labels:
      severity: warning
      service: nebula-personal
    annotations:
      summary: "个人NebulaGraph会话使用率较高"
      description: "个人NebulaGraph会话使用率达到 {{ $value }}%，超过70%阈值"

  - alert: NebulaPersonalSessionLimitReached
    expr: nebula_num_sessions >= nebula_max_sessions
    for: 2m  # 缩短告警时间以更快响应
    labels:
      severity: warning  # 保持告警级别
      service: nebula-personal
    annotations:
      summary: "个人NebulaGraph会话限制已达到"
      description: "个人NebulaGraph活跃会话数已达到最大限制 {{ $value }} 个"

  - alert: NebulaPersonalServiceDown
    expr: up{job=~"nebula-personal.*"} == 0
    for: 30s
    labels:
      severity: critical
      service: nebula-personal
    annotations:
      summary: "个人NebulaGraph服务不可用"
      description: "个人NebulaGraph服务已停止响应"